function sliderHeight() {

    wh = $(window).height();
    $('#slide1').css({ height: wh });

}

function mymargtop() {
    var body_h = $(window).height();
    var container_h = $('.filtr_bg').height();
    var marg_top = Math.abs((body_h - container_h) / 2);
    $('.filtr_bg').css('margin-top', marg_top);
    $('.filtr_bg').css('margin-bottom', marg_top);
}

function drop_menu() {
    //DROP menu
    if ($(window).width() < 750) {
        $("#github").hide();
        $(".navigation li").click(function () {
            $(".navigation").slideToggle("slow");
        });
    } else {
        $("#github").show();
    }
}


jQuery(document).ready(function ($) {
    //commit calendar
    var cal = new CalHeatMap();
    var convertedData = new Array();

    var commitData = JSON.parse('[["2013/01/09",0],["2013/01/10",0],["2013/01/11",0],["2013/01/12",0],["2013/01/13",0],["2013/01/14",0],["2013/01/15",0],["2013/01/16",0],["2013/01/17",0],["2013/01/18",0],["2013/01/19",0],["2013/01/20",0],["2013/01/21",0],["2013/01/22",0],["2013/01/23",0],["2013/01/24",0],["2013/01/25",0],["2013/01/26",0],["2013/01/27",5],["2013/01/28",0],["2013/01/29",0],["2013/01/30",0],["2013/01/31",0],["2013/02/01",0],["2013/02/02",0],["2013/02/03",0],["2013/02/04",0],["2013/02/05",0],["2013/02/06",0],["2013/02/07",0],["2013/02/08",0],["2013/02/09",0],["2013/02/10",0],["2013/02/11",0],["2013/02/12",0],["2013/02/13",0],["2013/02/14",0],["2013/02/15",0],["2013/02/16",0],["2013/02/17",0],["2013/02/18",0],["2013/02/19",0],["2013/02/20",0],["2013/02/21",0],["2013/02/22",0],["2013/02/23",0],["2013/02/24",1],["2013/02/25",0],["2013/02/26",0],["2013/02/27",0],["2013/02/28",0],["2013/03/01",0],["2013/03/02",0],["2013/03/03",0],["2013/03/04",0],["2013/03/05",0],["2013/03/06",0],["2013/03/07",0],["2013/03/08",0],["2013/03/09",0],["2013/03/10",0],["2013/03/11",0],["2013/03/12",3],["2013/03/13",0],["2013/03/14",0],["2013/03/15",0],["2013/03/16",0],["2013/03/17",1],["2013/03/18",0],["2013/03/19",1],["2013/03/20",0],["2013/03/21",0],["2013/03/22",0],["2013/03/23",0],["2013/03/24",1],["2013/03/25",0],["2013/03/26",0],["2013/03/27",0],["2013/03/28",0],["2013/03/29",0],["2013/03/30",0],["2013/03/31",1],["2013/04/01",0],["2013/04/02",0],["2013/04/03",0],["2013/04/04",0],["2013/04/05",0],["2013/04/06",1],["2013/04/07",2],["2013/04/08",0],["2013/04/09",2],["2013/04/10",0],["2013/04/11",1],["2013/04/12",0],["2013/04/13",0],["2013/04/14",2],["2013/04/15",10],["2013/04/16",2],["2013/04/17",1],["2013/04/18",2],["2013/04/19",0],["2013/04/20",0],["2013/04/21",8],["2013/04/22",4],["2013/04/23",3],["2013/04/24",1],["2013/04/25",0],["2013/04/26",1],["2013/04/27",5],["2013/04/28",11],["2013/04/29",0],["2013/04/30",1],["2013/05/01",0],["2013/05/02",0],["2013/05/03",0],["2013/05/04",6],["2013/05/05",1],["2013/05/06",2],["2013/05/07",0],["2013/05/08",0],["2013/05/09",0],["2013/05/10",0],["2013/05/11",0],["2013/05/12",0],["2013/05/13",0],["2013/05/14",0],["2013/05/15",0],["2013/05/16",0],["2013/05/17",0],["2013/05/18",0],["2013/05/19",0],["2013/05/20",0],["2013/05/21",0],["2013/05/22",0],["2013/05/23",0],["2013/05/24",0],["2013/05/25",0],["2013/05/26",0],["2013/05/27",0],["2013/05/28",0],["2013/05/29",0],["2013/05/30",0],["2013/05/31",0],["2013/06/01",0],["2013/06/02",0],["2013/06/03",0],["2013/06/04",0],["2013/06/05",0],["2013/06/06",0],["2013/06/07",0],["2013/06/08",0],["2013/06/09",0],["2013/06/10",0],["2013/06/11",0],["2013/06/12",0],["2013/06/13",0],["2013/06/14",0],["2013/06/15",0],["2013/06/16",25],["2013/06/17",3],["2013/06/18",0],["2013/06/19",0],["2013/06/20",0],["2013/06/21",0],["2013/06/22",20],["2013/06/23",4],["2013/06/24",0],["2013/06/25",3],["2013/06/26",3],["2013/06/27",0],["2013/06/28",0],["2013/06/29",0],["2013/06/30",0],["2013/07/01",0],["2013/07/02",0],["2013/07/03",0],["2013/07/04",0],["2013/07/05",0],["2013/07/06",0],["2013/07/07",0],["2013/07/08",0],["2013/07/09",0],["2013/07/10",0],["2013/07/11",0],["2013/07/12",0],["2013/07/13",0],["2013/07/14",0],["2013/07/15",0],["2013/07/16",0],["2013/07/17",2],["2013/07/18",0],["2013/07/19",0],["2013/07/20",0],["2013/07/21",0],["2013/07/22",0],["2013/07/23",0],["2013/07/24",2],["2013/07/25",0],["2013/07/26",0],["2013/07/27",1],["2013/07/28",0],["2013/07/29",8],["2013/07/30",0],["2013/07/31",8],["2013/08/01",0],["2013/08/02",0],["2013/08/03",0],["2013/08/04",0],["2013/08/05",0],["2013/08/06",3],["2013/08/07",1],["2013/08/08",0],["2013/08/09",0],["2013/08/10",0],["2013/08/11",0],["2013/08/12",0],["2013/08/13",0],["2013/08/14",0],["2013/08/15",3],["2013/08/16",0],["2013/08/17",0],["2013/08/18",1],["2013/08/19",2],["2013/08/20",0],["2013/08/21",2],["2013/08/22",2],["2013/08/23",3],["2013/08/24",2],["2013/08/25",0],["2013/08/26",11],["2013/08/27",0],["2013/08/28",4],["2013/08/29",3],["2013/08/30",0],["2013/08/31",0],["2013/09/01",1],["2013/09/02",0],["2013/09/03",0],["2013/09/04",0],["2013/09/05",4],["2013/09/06",0],["2013/09/07",0],["2013/09/08",1],["2013/09/09",3],["2013/09/10",2],["2013/09/11",0],["2013/09/12",1],["2013/09/13",1],["2013/09/14",2],["2013/09/15",0],["2013/09/16",0],["2013/09/17",0],["2013/09/18",0],["2013/09/19",0],["2013/09/20",0],["2013/09/21",0],["2013/09/22",0],["2013/09/23",0],["2013/09/24",0],["2013/09/25",0],["2013/09/26",0],["2013/09/27",0],["2013/09/28",0],["2013/09/29",0],["2013/09/30",3],["2013/10/01",2],["2013/10/02",3],["2013/10/03",3],["2013/10/04",1],["2013/10/05",0],["2013/10/06",1],["2013/10/07",0],["2013/10/08",3],["2013/10/09",1],["2013/10/10",0],["2013/10/11",3],["2013/10/12",2],["2013/10/13",2],["2013/10/14",3],["2013/10/15",6],["2013/10/16",3],["2013/10/17",0],["2013/10/18",0],["2013/10/19",0],["2013/10/20",0],["2013/10/21",0],["2013/10/22",0],["2013/10/23",1],["2013/10/24",4],["2013/10/25",2],["2013/10/26",1],["2013/10/27",2],["2013/10/28",4],["2013/10/29",2],["2013/10/30",11],["2013/10/31",0],["2013/11/01",0],["2013/11/02",2],["2013/11/03",2],["2013/11/04",1],["2013/11/05",2],["2013/11/06",4],["2013/11/07",0],["2013/11/08",0],["2013/11/09",2],["2013/11/10",2],["2013/11/11",0],["2013/11/12",0],["2013/11/13",1],["2013/11/14",2],["2013/11/15",1],["2013/11/16",0],["2013/11/17",0],["2013/11/18",0],["2013/11/19",0],["2013/11/20",0],["2013/11/21",0],["2013/11/22",0],["2013/11/23",0],["2013/11/24",0],["2013/11/25",0],["2013/11/26",0],["2013/11/27",0],["2013/11/28",0],["2013/11/29",0],["2013/11/30",0],["2013/12/01",0],["2013/12/02",5],["2013/12/03",1],["2013/12/04",0],["2013/12/05",0],["2013/12/06",0],["2013/12/07",0],["2013/12/08",0],["2013/12/09",0],["2013/12/10",0],["2013/12/11",1],["2013/12/12",0],["2013/12/13",0],["2013/12/14",1],["2013/12/15",1],["2013/12/16",3],["2013/12/17",1],["2013/12/18",1],["2013/12/19",1],["2013/12/20",0],["2013/12/21",0],["2013/12/22",0],["2013/12/23",0],["2013/12/24",0],["2013/12/25",0],["2013/12/26",7],["2013/12/27",0],["2013/12/28",0],["2013/12/29",0],["2013/12/30",0],["2013/12/31",0],["2014/01/01",0],["2014/01/02",0],["2014/01/03",0],["2014/01/04",0],["2014/01/05",0],["2014/01/06",3],["2014/01/07",0],["2014/01/08",0],["2014/01/09",0]]');

//    need to be authenticated to use this unfortunately
//    $.ajax({
//        url: 'https://github.com/users/jhunken/contributions_calendar_data',
//        dataType: "jsonp",
//        success: function (commitData) {
//            commitData.forEach(function (element, index, array) {
//
//                var dateStr = element[0];
//                var date = new Date(dateStr);
//                var ts = date.getTime() / 1000;
//                var obj = { date: ts, value: element[1] };
//                convertedData.push(obj);
//            });
//            var parser = function (data) {
//                var stats = {};
//                for (var d in data) {
//                    stats[data[d].date] = data[d].value;
//                }
//                return stats;
//            };
//            var startDate = new Date();
//            startDate.setFullYear(startDate.getFullYear() - 1);
//            cal.init({
//                data: convertedData,
//                start: startDate,
//                afterLoadData: parser,
//                domain: "month",					// Group data by days
//                subDomain: "day",				// Split each day by hours
//                range: 13,						// Number of days to display
//                browsing: true 				// Enable browsing
//            });
//        }
//    });

    commitData.forEach(function (element, index, array) {

        var dateStr = element[0];
        var date = new Date(dateStr);
        var ts = date.getTime() / 1000;
        var obj = { date: ts, value: element[1] };
        convertedData.push(obj);
    });
    var parser = function (data) {
        var stats = {};
        for (var d in data) {
            stats[data[d].date] = data[d].value;
        }
        return stats;
    };
    var startDate = new Date();
    startDate.setFullYear(startDate.getFullYear() - 1);
    cal.init({
        data: convertedData,
        start: startDate,
        afterLoadData: parser,
        //cellsize: 6,
        domain: "month",					// Group data by days
        subDomain: "day",				// Split each day by hours
        range: 13						// Number of days to display
        //browsing: true 				// Enable browsing
    });

    $(window).stellar();

    var links = $('.navigation').find('li');
    slide = $('.slide');
    button = $('.button');
    mywindow = $(window);
    htmlbody = $('html,body');

    /**/
    if (mywindow.scrollTop() < 1) {
        $('.navigation li[data-slide="1"]').addClass('active');
    }
    /**/

    slide.waypoint(function (event, direction) {

        dataslide = $(this).attr('data-slide');

        if (direction === 'down') {
            $('.navigation li[data-slide="' + dataslide + '"]').addClass('active').prev().removeClass('active');

            $('.navigation li[data-slide="1"]').removeClass('active');

        }
        else {
            $('.navigation li[data-slide="' + dataslide + '"]').addClass('active').next().removeClass('active');
        }

    });

    mywindow.scroll(function () {
        if (mywindow.scrollTop() == 0) {
            $('.navigation li[data-slide="1"]').addClass('active');
            $('.navigation li[data-slide="2"]').removeClass('active');
        }
    });

    /*function goToByScroll(dataslide) {
     htmlbody.animate({
     scrollTop: $('.slide[data-slide="' + dataslide + '"]').offset().top + 1
     }, 2000, 'easeInOutQuint');
     }*/

    function goToByScroll(dataslide) {
        var goal = $('.slide[data-slide="' + dataslide + '"]').offset().top;
        if (mywindow.scrollTop() < goal) {
            var goalPx = goal + 5;
        } else {
            var goalPx = goal - 76;
        }
        htmlbody.animate({
            scrollTop: goalPx
        }, 2000, 'easeInOutQuint');
    }


    links.click(function (e) {
        e.preventDefault();
        dataslide = $(this).attr('data-slide');
        goToByScroll(dataslide);
    });

    button.click(function (e) {
        e.preventDefault();
        dataslide = $(this).attr('data-slide');
        goToByScroll(dataslide);

    });


    // Sticky Navigation	
    $(".menu").sticky({ topSpacing: 0 });

    //DROP menu
    $(".btn_dropdown").click(function () {
        $(".navigation").slideToggle("slow");
    });


    //prettyPhoto
    $("a[rel^='prettyPhoto']").prettyPhoto();


    drop_menu();

    sliderHeight();

    mymargtop();

    $("#slide1").each(function () {
        var slide_h = $(this).height();

        $(this).css('background-size', '100% ' + slide_h + 'px');

    });

});

$(window).bind('resize', function () {

    //Update slider height
    sliderHeight();

    mymargtop();

});

$(window).resize(function () {


    drop_menu();

});




